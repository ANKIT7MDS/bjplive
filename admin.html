<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <title>‡§≠‡§æ‡§ú‡§™‡§æ ‡§Ü‡§ó‡§Ç‡§§‡•Å‡§ï ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</title>
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet"
    href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
  <link rel="stylesheet"
    href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.bootstrap5.min.css">
  <style>
    body {
      background-color: #fff8f0;
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
    }

    h2 {
      text-align: center;
      color: #e65100;
      font-weight: bold;
      margin-bottom: 25px;
    }

    table.dataTable thead {
      background-color: #ffa726;
      color: white;
    }

    .dataTables_wrapper .dt-buttons .btn {
      background-color: #ffa726 !important;
      color: white !important;
      border: none;
      margin-right: 5px;
    }

    .dataTables_wrapper .dataTables_filter input {
      border: 1px solid #ffa726;
      border-radius: 4px;
    }

    table img {
      width: 60px;
      height: auto;
      border-radius: 6px;
      border: 2px solid #ffcc80;
    }

    .alert-danger {
      text-align: center;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="container">
  <h2>üìä ‡§≠‡§æ‡§ú‡§™‡§æ ‡§Ü‡§ó‡§Ç‡§§‡•Å‡§ï ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</h2>
  <table id="dashboard" class="table table-striped table-bordered" style="width:100%">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞</th>
        <th>‡§®‡§æ‡§Æ</th>
        <th>‡§™‡§¶</th>
        <th>‡§Æ‡§Ç‡§°‡§≤</th>
        <th>‡§¨‡•Ç‡§• / ‡§µ‡§æ‡§∞‡•ç‡§° / ‡§™‡§§‡§æ</th>
        <th>purpose</th>
        <th>Selfie</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js"></script>

<script>
  const SHEET_URL = "https://opensheet.elk.sh/1aqTbXmF4FqWdVja3K_z3EjtIlzGuPvUuyk59U9ZmSII/Sheet1";

  fetch(SHEET_URL)
    .then(res => res.json())
    .then(rawData => {
      // üß† Sheet ‡§ï‡•Ä ‡§π‡§ø‡§Ç‡§¶‡•Ä keys ‡§ï‡•ã English keys ‡§∏‡•á map ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç
      const data = rawData.map(row => ({
        Timestamp: row['Timestamp'],
        mobile: row['‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞'],
        name: row['‡§®‡§æ‡§Æ'],
        post: row['‡§™‡§¶'],
        mandal: row['‡§Æ‡§Ç‡§°‡§≤'],
        address: row['‡§¨‡•Ç‡§• / ‡§µ‡§æ‡§∞‡•ç‡§° / ‡§™‡§§‡§æ'],
        purpose: row['‡§Ü‡§®‡•á ‡§ï‡§æ ‡§ï‡§æ‡§∞‡§£'],  // ‚úÖ ‡§Ø‡§π‡§æ‡§Å mapping ‡§π‡•ã ‡§ó‡§Ø‡§æ
        selfie: row['Selfie']
      }));

      $('#dashboard').DataTable({
        data: data,
        columns: [
          { data: 'Timestamp' },
          { data: 'mobile' },
          { data: 'name' },
          { data: 'post' },
          { data: 'mandal' },
          { data: 'address' },
          { data: 'purpose' },  // ‚úÖ English alias, mapped from Hindi key
          {
            data: 'selfie',
            render: function (data) {
              return data && data.startsWith('data:image')
                ? `<img src="${data}" alt="Selfie" />`
                : '';
            }
          }
        ],
        dom: 'Bfrtip',
        buttons: ['copy', 'csv', 'excel', 'pdf', 'print'],
        order: [[0, 'desc']],
        pageLength: 10
      });
    })
    .catch(err => {
      console.error("Error loading data:", err);
      $('.container').prepend(
        `<div class="alert alert-danger">‡§°‡•á‡§ü‡§æ ‡§≤‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${err.message}</div>`
      );
    });
</script>


</body>
</html>
