<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>рдЖрдЧрдВрддреБрдХ рдлреЙрд░реНрдо</title>
  <style>
    body {
      background: #ffecb3;
      font-family: sans-serif;
      display: flex;
      justify-content: center;
      padding: 40px;
    }
    form {
      background: #ff9800;
      padding: 20px;
      border-radius: 8px;
      color: white;
      width: 100%;
      max-width: 500px;
    }
    input, select, button {
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      border-radius: 4px;
      border: none;
    }
    button {
      background: #e65100;
      color: white;
      cursor: pointer;
    }
    video, canvas {
      display: block;
      width: 100%;
      border-radius: 4px;
      margin-top: 10px;
    }
    .message {
      margin-top: 10px;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>
  <form id="visitorForm">
    <h2>ЁЯкк рднрд╛рдЬрдкрд╛ рдХрд╛рд░реНрдпрд╛рд▓рдп рдкрд░ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ</h2>
    <input type="text" name="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░" placeholder="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░" required>
    <input type="text" name="рдирд╛рдо" placeholder="рдирд╛рдо" required>
    <input type="text" name="рдкрдж" placeholder="рдкрдж">
    
    <select name="рдордВрдбрд▓" required>
      <option value="">рдордВрдбрд▓ рдЪреБрдиреЗрдВ</option>
      <option>рднреИрдВрд╕реЛрджрд╛</option>
      <option>рднрд╛рдирдкреБрд░рд╛</option>
      <option>рдЧрд░реЛрда</option>
      <option>рдореЗрд▓рдЦреЗрдбрд╝рд╛</option>
      <option>рдЦрдбрд╝рд╛рд╡рджрд╛</option>
      <option>рд╢рд╛рдордЧрдврд╝</option>
      <option>рд╕реБрд╢рд╡рд╛рдбрд╝рд╛</option>
      <option>рдмрд╕рдИ</option>
      <option>рд╕реАрддрд╛рдордК рдЧреНрд░рд╛рдореАрдг</option>
      <option>рд╕реАрддрд╛рдордК</option>
      <option>рдХреИрдВрдкреБрд░</option>
      <option>рдЧреБрд░реНрдЬрд░ рдмрд░реНрдбрд┐рдпрд╛</option>
      <option>рдвреБрдВрдврдбрд╝рдХрд╛</option>
      <option>рдкрд┐рдкрд▓рд┐рдпрд╛ рдордВрдбреА</option>
      <option>рдмреВрдврд╝рд╛</option>
      <option>рдорд▓реНрд╣рд╛рд░рдЧрдврд╝</option>
      <option>рджрд▓реЛрджрд╛</option>
      <option>рдордЧрд░рдорд╛рддрд╛ рдЬреА</option>
      <option>рдордВрджрд╕реМрд░ рдЧреНрд░рд╛рдореАрдг</option>
      <option>рдордВрджрд╕реМрд░ рджрдХреНрд╖рд┐рдг</option>
      <option>рдордВрджрд╕реМрд░ рдЙрддреНрддрд░</option>
    </select>

    <input type="text" name="Booth" placeholder="рдмреВрде / рд╡рд╛рд░реНрдб / рдкрддрд╛">

    <select name="рдЖрдиреЗ рдХрд╛ рдХрд╛рд░рдг" required>
      <option value="">рдЖрдиреЗ рдХрд╛ рдХрд╛рд░рдг</option>
      <option>рдХрд╛рд░реНрдпрд╛рд▓рдп рдкрд░ рдмреИрдардХ рдореЗрдВ</option>
      <option>рдорд╛рдирдиреАрдп рдЬрд┐рд▓рд╛ рдЕрдзреНрдпрдХреНрд╖ рдЬреА рд╕реЗ рдХрд┐рд╕реА рдХрд╛рд░реНрдп рд╣реЗрддреБ рднреЗрдВрдЯ</option>
      <option>рдЯреНрд░рд╛рдВрд╕рдлрд░ рдпрд╛ рдЕрдиреНрдп рдХреЛрдИ рд╢рд╛рд╕рдХреАрдп рдХрд╛рд░реНрдп / рд╢рд┐рдХрд╛рдпрдд</option>
      <option>рдХрд╛рд░реНрдпрд╛рд▓рдп рдкрд░ рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрд╕реНрдерд┐рддрд┐</option>
      <option>рдЕрдиреНрдп рдХреЛрдИ рдХрд╛рд░реНрдп</option>
    </select>

    <!-- Hidden input for selfie -->
    <input type="hidden" name="Selfie" id="selfieInput">

    <!-- Camera view -->
    <video id="video" autoplay></video>
    <canvas id="canvas" style="display:none;"></canvas>
    <button type="button" onclick="capturePhoto()">ЁЯУ╕ рдлреЛрдЯреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдВ</button>
    <div id="photoStatus" class="message"></div>

    <button type="submit">ЁЯУи рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ</button>
    <div id="submitStatus" class="message"></div>
  </form>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const selfieInput = document.getElementById('selfieInput');
    const photoStatus = document.getElementById('photoStatus');
    const submitStatus = document.getElementById('submitStatus');

    // рдХреИрдорд░рд╛ рдЪрд╛рд▓реВ рдХрд░реЗрдВ
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => { video.srcObject = stream; })
      .catch(err => { alert("рдХреИрдорд░рд╛ рдЪрд╛рд▓реВ рдирд╣реАрдВ рд╣реЛ рдкрд╛рдпрд╛"); });

    // рдлреЛрдЯреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдВ
    function capturePhoto() {
      const context = canvas.getContext('2d');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      const dataURL = canvas.toDataURL('image/png');
      selfieInput.value = dataURL;
      photoStatus.textContent = "тЬЕ рдлреЛрдЯреЛ рдХреИрдкреНрдЪрд░ рд╣реЛ рдЧрдИ рд╣реИ";
    }

    // рдлреЙрд░реНрдо рд╕рдмрдорд┐рдЯ
    document.getElementById('visitorForm').addEventListener('submit', e => {
      e.preventDefault();
      submitStatus.textContent = "ЁЯФД рд╕рдмрдорд┐рдЯ рд╣реЛ рд░рд╣рд╛ рд╣реИ...";
      
      const formData = new FormData(e.target);
      fetch("https://script.google.com/macros/s/AKfycbxZhcfU-fSRpFCgvqhAVUiSUJNquaaZNEY-3DbPF_d3dDQisATFcGLH5_kbN-iebqB0/exec", {
        method: "POST",
        body: new URLSearchParams(formData)
      })
      .then(res => res.json())
      .then(data => {
        if (data.result === "success") {
          submitStatus.innerHTML = "ЁЯОЙ рдЖрдкрдХрд╛ рдлреЙрд░реНрдо рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕рдмрдорд┐рдЯ рд╣реБрдЖ<br>рднрд╛рдЬрдкрд╛ рдХрд╛рд░реНрдпрд╛рд▓рдп рдкрд░ рдЖрдкрдХрд╛ рд╣рд╛рд░реНрджрд┐рдХ рд╕реНрд╡рд╛рдЧрдд рд╣реИ";
          e.target.reset();
          photoStatus.textContent = "";
        } else {
          submitStatus.textContent = "тЭМ рддреНрд░реБрдЯрд┐: " + data.error;
        }
      })
      .catch(err => {
        submitStatus.textContent = "тЭМ рдиреЗрдЯрд╡рд░реНрдХ рддреНрд░реБрдЯрд┐: " + err.message;
      });
    });
  </script>
</body>
</html>
