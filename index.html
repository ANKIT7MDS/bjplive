<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <title>рднрд╛рдЬрдкрд╛ рдХрд╛рд░реНрдпрд╛рд▓рдп рдлреЙрд░реНрдо</title>
  <style>
    body {
      font-family: sans-serif;
      background: #fff5e6;
      padding: 20px;
    }
    label {
      font-weight: bold;
    }
    input, select, button {
      display: block;
      margin: 8px 0;
      padding: 8px;
      width: 300px;
      max-width: 100%;
    }
    video, canvas {
      border-radius: 10px;
      border: 2px solid #888;
      margin-top: 10px;
    }
    #selfiePreview {
      display: none;
      width: 150px;
      margin-top: 10px;
      border: 2px solid green;
      border-radius: 8px;
    }
    .success {
      color: green;
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h2>ЁЯУЛ рднрд╛рдЬрдкрд╛ рдХрд╛рд░реНрдпрд╛рд▓рдп рдЖрдЧрдВрддреБрдХ рдлреЙрд░реНрдо</h2>

<form id="myForm" method="POST" action="https://script.google.com/macros/s/AKfycbxZhcfU-fSRpFCgvqhAVUiSUJNquaaZNEY-3DbPF_d3dDQisATFcGLH5_kbN-iebqB0/exec">
  <label>рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░:</label>
  <input type="text" name="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░" required />

  <label>рдирд╛рдо:</label>
  <input type="text" name="рдирд╛рдо" required />

  <label>рдкрдж:</label>
  <input type="text" name="рдкрдж" />

  <label>рдордВрдбрд▓:</label>
  <select name="рдордВрдбрд▓" required>
    <option value="">рдордВрдбрд▓ рдЪреБрдиреЗрдВ</option>
    <option>рднреИрд╕рджрд╛</option>
    <option>рднрд╛рдирдкреБрд░рд╛</option>
    <option>рдЧрд░реЛрда</option>
    <option>рдореЗрд▓рдЦреЗрдбрд╝рд╛</option>
    <option>рдЦрдЦрд░рд╛рдЦреЗрдбрд╝реА</option>
    <option>рд╕рд╛рдордЧрдврд╝</option>
    <option>рд╕реБрдЦрд╛рд╡рдбрд╝рд╛</option>
    <option>рдмрд╕рдИ</option>
    <option>рд╕реАрддрд╛рдордК рдЧреНрд░рд╛рдореАрдг</option>
    <option>рд╕реАрддрд╛рдордК</option>
    <option>рдХрдВрд╡рд▓рд╛</option>
    <option>рдЧреБрд░реНрдЬрд░ рдмрд░реНрдбрд┐рдпрд╛</option>
    <option>рдмреБрдВрджрдбрд╝рдХрд╛</option>
    <option>рдкрд┐рдкрд▓рд┐рдпрд╛ рдордВрдбреА</option>
    <option>рдмреБрдврд╛</option>
    <option>рдорд╣реВрдЧрдврд╝</option>
    <option>рджрддрд╛рд╡</option>
    <option>рдордЧрд░рд╛рдорддреНрддрд╛ рдЬреА</option>
    <option>рдордВрджрд╕реМрд░ рдЧреНрд░рд╛рдореАрдг</option>
  </select>

  <label>рдмреВрде / рд╡рд╛рд░реНрдб / рдкрддрд╛:</label>
  <input type="text" name="рдмреВрде / рд╡рд╛рд░реНрдб / рдкрддрд╛" />

  <label>рдЖрдиреЗ рдХрд╛ рдХрд╛рд░рдг:</label>
  <select name="purpose" required>
    <option value="">рдЖрдиреЗ рдХрд╛ рдХрд╛рд░рдг рдЪреБрдиреЗрдВ</option>
    <option>рдХрд╛рд░реНрдпрд╛рд▓рдп рдкрд░ рдмреИрдардХ рдореЗрдВ</option>
    <option>рдорд╛рдирдиреАрдп рдЬрд┐рд▓рд╛ рдЕрдзреНрдпрдХреНрд╖ рдЬреА рд╕реЗ рдХрд┐рд╕реА рдХрд╛рд░реНрдп рд╣реЗрддреБ рднреЗрдВрдЯ</option>
    <option>рдЯреНрд░рд╛рдВрд╕рдлрд░ рдпрд╛ рдЕрдиреНрдп рдХреЛрдИ рд╢рд╛рд╕рдХреАрдп рдХрд╛рд░реНрдп / рд╢рд┐рдХрд╛рдпрдд</option>
    <option>рдХрд╛рд░реНрдпрд╛рд▓рдп рдкрд░ рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрд╕реНрдерд┐рддрд┐</option>
    <option>рдЕрдиреНрдп рдХреЛрдИ рдХрд╛рд░реНрдп</option>
  </select>

  <!-- Hidden Selfie Field -->
  <input type="hidden" name="Selfie" id="selfieInput" />

  <!-- Video + Photo Capture -->
  <video id="camera-stream" width="300" height="220" autoplay></video><br>
  <button type="button" id="capture">ЁЯУ╕ рдлреЛрдЯреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдВ</button><br>
  <img id="selfiePreview" />
  <canvas id="canvas" width="300" height="220" style="display:none;"></canvas>

  <div id="statusMessage" class="success"></div>

  <br>
  <button type="submit">тЬЕ рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ</button>
</form>

<script>
  const video = document.getElementById('camera-stream');
  const canvas = document.getElementById('canvas');
  const selfieInput = document.getElementById('selfieInput');
  const captureBtn = document.getElementById('capture');
  const preview = document.getElementById('selfiePreview');
  const statusMsg = document.getElementById('statusMessage');
  const form = document.getElementById('myForm');

  // ЁЯУ╖ Get camera
  navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
    video.srcObject = stream;
  }).catch(err => {
    console.error("Camera error:", err);
    alert("рдХреИрдорд░рд╛ рдЪрд╛рд▓реВ рдирд╣реАрдВ рд╣реЛ рдкрд╛рдпрд╛! рдХреГрдкрдпрд╛ рдЕрдиреБрдорддрд┐ рджреЗрдВ рдпрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдмрджрд▓реЗрдВред");
  });

  // ЁЯУ╕ Capture and store base64 image
  captureBtn.addEventListener('click', () => {
    const context = canvas.getContext('2d');
    context.drawImage(video, 0, 0, canvas.width, canvas.height);
    const imageData = canvas.toDataURL('image/png');
    selfieInput.value = imageData;
    preview.src = imageData;
    preview.style.display = 'block';
    statusMsg.textContent = "тЬЕ рдлреЛрдЯреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХреИрдкреНрдЪрд░ рд╣реБрдЖред";
  });

  // ЁЯУд Confirmation message after form submit
  form.addEventListener('submit', function(e) {
    if (!selfieInput.value) {
      e.preventDefault();
      alert("рдХреГрдкрдпрд╛ рдкрд╣рд▓реЗ рдлреЛрдЯреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдВ ЁЯУ╕");
      return;
    }

    statusMsg.textContent = "ЁЯЪА рд╕рдмрдорд┐рдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ...";
  });
</script>

</body>
</html>
